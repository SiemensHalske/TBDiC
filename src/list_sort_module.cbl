IDENTIFICATION DIVISION.
PROGRAM-ID. ARRAY-SORT-PROGRAM.

ENVIRONMENT DIVISION.
INPUT-OUTPUT SECTION.
FILE-CONTROL.
    SELECT INPUT-FILE ASSIGN TO "input-file.txt"
        ORGANIZATION IS LINE SEQUENTIAL.
    SELECT OUTPUT-FILE ASSIGN TO "output-file.txt"
        ORGANIZATION IS LINE SEQUENTIAL.

DATA DIVISION.
FILE SECTION.
    FD INPUT-FILE.
    01 CUSTOMER-RECORD PIC X(100).
    FD OUTPUT-FILE.
    01 CUSTOMER-RECORD-OUT PIC X(100).

WORKING-STORAGE SECTION.
    01 CUSTOMER-ARRAY OCCURS 100 TIMES PIC X(100).
    01 CUSTOMER-COUNT PIC 99 VALUE 0.
    01 TEMP-CUSTOMER-ARRAY OCCURS 100 TIMES PIC X(100).

PROCEDURE DIVISION.
    OPEN INPUT INPUT-FILE
    OPEN OUTPUT OUTPUT-FILE

    * Read the customer records from the input file into the customer array.
    PERFORM UNTIL EOF(INPUT-FILE)
        READ INPUT-FILE INTO CUSTOMER-ARRAY(CUSTOMER-COUNT + 1)
        CUSTOMER-COUNT = CUSTOMER-COUNT + 1
    END-PERFORM

    * Sort the customer array using merge sort.
    PERFORM MERGE-SORT(1, CUSTOMER-COUNT)

    * Write the sorted customer records to the output file.
    PERFORM VARYING CURRENT-CUSTOMER-INDEX FROM 1 BY 1 UNTIL CURRENT-CUSTOMER-INDEX > CUSTOMER-COUNT
        MOVE CUSTOMER-ARRAY(CURRENT-CUSTOMER-INDEX) TO CUSTOMER-RECORD-OUT
        WRITE OUTPUT-FILE FROM CUSTOMER-RECORD-OUT
    END-PERFORM

    CLOSE INPUT INPUT-FILE OUTPUT OUTPUT-FILE
    STOP RUN.

MERGE-SORT SECTION.
    01 LEFT-INDEX PIC 99.
    01 RIGHT-INDEX PIC 99.
    01 MIDDLE-INDEX PIC 99.
    01 I PIC 99.
    01 J PIC 99.
    01 K PIC 99.

    IF LEFT-INDEX < RIGHT-INDEX
        MOVE LEFT-INDEX TO MIDDLE-INDEX
        ADD RIGHT-INDEX TO MIDDLE-INDEX
        DIVIDE 2 INTO MIDDLE-INDEX

        PERFORM MERGE-SORT(LEFT-INDEX, MIDDLE-INDEX)
        PERFORM MERGE-SORT(MIDDLE-INDEX + 1, RIGHT-INDEX)

        PERFORM VARYING I FROM LEFT-INDEX BY 1 UNTIL I > MIDDLE-INDEX
            MOVE CUSTOMER-ARRAY(I) TO TEMP-CUSTOMER-ARRAY(I)
        END-PERFORM

        PERFORM VARYING J FROM MIDDLE-INDEX + 1 BY 1 UNTIL J > RIGHT-INDEX
            MOVE CUSTOMER-ARRAY(RIGHT-INDEX - J + MIDDLE-INDEX + 2) TO TEMP-CUSTOMER-ARRAY(J)
        END-PERFORM

        MOVE LEFT-INDEX TO I
        MOVE RIGHT-INDEX TO J

        PERFORM VARYING K FROM LEFT-INDEX BY 1 UNTIL K > RIGHT-INDEX
            IF TEMP-CUSTOMER-ARRAY(I) < TEMP-CUSTOMER-ARRAY(J)
                MOVE TEMP-CUSTOMER-ARRAY(I) TO CUSTOMER-ARRAY(K)
                ADD 1 TO I
            ELSE
                MOVE TEMP-CUSTOMER-ARRAY(J) TO CUSTOMER-ARRAY(K)
                SUBTRACT 1 FROM J
            END-IF
        END-PERFORM
    END-IF.